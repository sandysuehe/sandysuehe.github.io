---
layout: article 
title: "机器学习入门"
date: 2017-07-10 19:37:07 +0800
categories: ml 
---
> 简介：本文主要对机器学习进行了入门级的简单介绍。

> 背景：最近机器学习，人工智能等概念越来越火，针对相关概念，结合浅显易懂的例子，做出了相关的词汇介绍。

## 一、什么是机器学习？
### 1. 简单案例说明
##### 怎么教婴儿识别苹果和梨？
###### 规律：
- If 红色 and 圆形：
      苹果
- If 黄色 and 椭圆形：
      梨

### 2. 机器学习的本质
#### 本质： 根据历史看到的样本，总结规律

#### 几个概念：
    样本: 全量样本 （大量苹果and梨等水果）
    规则: 海量规则, 根据特征对样本分类（If 红色 and 圆形：苹果； If 黄色 and 椭圆形：梨）
    总结: 机器总结, 能够“看”海量样本总结海量规则的核心原因

#### 机器总结基本原理：
   定义一个损失函数（错误率）尝试所有的划分方法，取损失函数最小的划分方法
   
 
##### 实际：
    穷举计算量太大 -> mini batch, 剪枝等
    太精细带来的过拟合 -> 正则的惩罚

## 二、如何应用机器学习到实际问题？

### 1. 机器学习的四大步骤
#### 问题定义： 给一个水果，判断是苹果还是梨？

    收集样本： 回忆以前见过的苹果和梨
    提取特征：根据以前见过的苹果和梨，找到有区分性的特征，比如颜色，形状，粗糙度
    模型训练：根据这些特征，总结区分的规律， y=f(颜色，形状，粗糙度，等) (y in [0,1])
    预测： 下次来了一个新的苹果或者梨的时候，根据规律判断, new(红，椭圆形，粗糙)=0.7

### 2. 样本和特征的原则
- 收集样本-样本选择原则：最贴近实际应用的样本
- 提取特征-特征设计原则：业务经验觉得的和目标相关的所有因素
- 模型训练


## 三、怎么科学的评估(Eval)？
### 1. 线下评估
   在模型真正投入使用前，利用历史样本（时间划分样本）评估模型效果。
   
##### 训练集
     训练数据：T-t月的数据, 用于训练模型
     测试数据：T-1月的数据, 用于评估模型

### 2. 线上评估
   A/B Test
   
### 3. 线下评估指标
二分类问题的预测结果可能正确，也可能不正确。

- 结果正确存在两种可能：原本对的预测为对（True Positives），原本错的预测为错（False Negatives）；
- 结果错误也存在两种可能：原本对的预测为错（True Neagtives），原本错的预测为对（False Positives）；

![正负样本分布](https://github.com/sandysuehe/sandysuehe.github.io/blob/master/images/ml.jpeg?raw=true)

  如Fig 1左侧所示。
  
  - 其中Positives代表预测是对的，Negatives代表预测是错的；True代表原本为对，False代表原本为错。
  - 原本对的预测为对 TP，原本错的预测为错 FN， 原本对的预测为错TN，原本错的预测为对FP。
  - P = TP + FN
  - N = TN + FP


#### 1). 准确率(accuracy)
     整个样本当中，原本是对的比例（原本是对的预测为对+原本是对的预测为错）
     accuracy = TP+TN／(P+N) 
     越大越好，1为理想

#### 2). 精准率(precision)
     预测为对的当中，原本为对的比例
     precision = TP/(TP+FP)
     越大越好，1为理想
     
#### 3). 召回率(recall)  
     原本为对的当中，预测为对的比例
     precision = TP/(TP+FN)
     越大越好，1为理想
     
#### 4). 综合评价指标(F-Measure)
     Precision和Recall加权调和平均
     F = 2PR/(P+R)
     越大越好，1为理想状态，此时precision为1，recall为1


#### 5). fp rate
     原本是错的预测为对的比例
     fp = FP／N
     越小越好，0为理想状态
     
#### 6). tp rate
     原本是对的预测为对的比例
     tp rate = TP/P
     越大越好，1为理想状态
  
#### 案例说明：
    【实际情况】1000个水果（500个苹果，500个梨）目标挑出所有的苹果。
    【模型预测】以y>0.5为阈值，找出共300个水果，认为是评估，其中有250个苹果，另外还错误的把50个梨也当作苹果挑出来了。

![案例说明](https://github.com/sandysuehe/sandysuehe.github.io/blob/master/images/ml_sample.png?raw=true)
   
【分析】

1. 准确率accuracy = (TP+TN)/(P+N) = (250+450)/1000 = 0.7
2. 精确率precision = TP/(TP+FP) = 250/(250+50) = 0.833
3. 召回率recall = TP/(TP+FN) = 250/(250+250) = 0.5
4. 综合评价指标F-Measure= 2PR／P+R = 2*0.83*0.5/(0.83+0.5) = 0.62
